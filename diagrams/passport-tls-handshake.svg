<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="656" width="544" viewBox="0 0 544 656" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
<path d="M 8,16 L 8,48" fill="none" stroke="black"/>
<path d="M 8,80 L 8,576" fill="none" stroke="black"/>
<path d="M 40,48 L 40,80" fill="none" stroke="black"/>
<path d="M 40,112 L 40,640" fill="none" stroke="black"/>
<path d="M 72,16 L 72,48" fill="none" stroke="black"/>
<path d="M 128,16 L 128,48" fill="none" stroke="black"/>
<path d="M 136,96 L 136,112" fill="none" stroke="black"/>
<path d="M 176,48 L 176,112" fill="none" stroke="black"/>
<path d="M 232,16 L 232,48" fill="none" stroke="black"/>
<path d="M 320,16 L 320,48" fill="none" stroke="black"/>
<path d="M 352,48 L 352,640" fill="none" stroke="black"/>
<path d="M 384,16 L 384,48" fill="none" stroke="black"/>
<path d="M 448,16 L 448,48" fill="none" stroke="black"/>
<path d="M 488,48 L 488,592" fill="none" stroke="black"/>
<path d="M 536,16 L 536,48" fill="none" stroke="black"/>
<path d="M 536,128 L 536,576" fill="none" stroke="black"/>
<path d="M 8,16 L 72,16" fill="none" stroke="black"/>
<path d="M 128,16 L 232,16" fill="none" stroke="black"/>
<path d="M 320,16 L 384,16" fill="none" stroke="black"/>
<path d="M 448,16 L 536,16" fill="none" stroke="black"/>
<path d="M 8,48 L 72,48" fill="none" stroke="black"/>
<path d="M 128,48 L 232,48" fill="none" stroke="black"/>
<path d="M 320,48 L 384,48" fill="none" stroke="black"/>
<path d="M 448,48 L 536,48" fill="none" stroke="black"/>
<path d="M 8,80 L 120,80" fill="none" stroke="black"/>
<path d="M 8,112 L 520,112" fill="none" stroke="black"/>
<path d="M 40,224 L 344,224" fill="none" stroke="black"/>
<path d="M 352,256 L 480,256" fill="none" stroke="black"/>
<path d="M 360,288 L 488,288" fill="none" stroke="black"/>
<path d="M 48,432 L 352,432" fill="none" stroke="black"/>
<path d="M 40,448 L 64,448" fill="none" stroke="black"/>
<path d="M 48,480 L 64,480" fill="none" stroke="black"/>
<path d="M 40,496 L 64,496" fill="none" stroke="black"/>
<path d="M 48,528 L 64,528" fill="none" stroke="black"/>
<path d="M 40,560 L 344,560" fill="none" stroke="black"/>
<path d="M 24,592 L 520,592" fill="none" stroke="black"/>
<path d="M 48,624 L 344,624" fill="none" stroke="black"/>
<path d="M 120,80 C 128.83064,80 136,87.16936 136,96" fill="none" stroke="black"/>
<path d="M 520,112 C 528.83064,112 536,119.16936 536,128" fill="none" stroke="black"/>
<path d="M 64,448 C 72.83064,448 80,455.16936 80,464" fill="none" stroke="black"/>
<path d="M 64,480 C 72.83064,480 80,472.83064 80,464" fill="none" stroke="black"/>
<path d="M 64,496 C 72.83064,496 80,503.16936 80,512" fill="none" stroke="black"/>
<path d="M 64,528 C 72.83064,528 80,520.83064 80,512" fill="none" stroke="black"/>
<path d="M 24,592 C 15.16936,592 8,584.83064 8,576" fill="none" stroke="black"/>
<path d="M 520,592 C 528.83064,592 536,584.83064 536,576" fill="none" stroke="black"/>
<polygon class="arrowhead" points="488,256 476,250.4 476,261.6 " fill="black" transform="rotate(0,480,256)"/>
<polygon class="arrowhead" points="368,288 356,282.4 356,293.6 " fill="black" transform="rotate(180,360,288)"/>
<polygon class="arrowhead" points="352,624 340,618.4 340,629.6 " fill="black" transform="rotate(0,344,624)"/>
<polygon class="arrowhead" points="352,560 340,554.4 340,565.6 " fill="black" transform="rotate(0,344,560)"/>
<polygon class="arrowhead" points="352,224 340,218.4 340,229.6 " fill="black" transform="rotate(0,344,224)"/>
<polygon class="arrowhead" points="56,624 44,618.4 44,629.6 " fill="black" transform="rotate(180,48,624)"/>
<polygon class="arrowhead" points="56,528 44,522.4 44,533.6 " fill="black" transform="rotate(180,48,528)"/>
<polygon class="arrowhead" points="56,480 44,474.4 44,485.6 " fill="black" transform="rotate(180,48,480)"/>
<polygon class="arrowhead" points="56,432 44,426.4 44,437.6 " fill="black" transform="rotate(180,48,432)"/>
<g class="text">
<text x="40" y="36">TLS A</text>
<text x="180" y="36">Verifier X</text>
<text x="352" y="36">TLS B</text>
<text x="492" y="36">Attester</text>
<text x="72" y="100">TLS handshake</text>
<text x="96" y="148">ClientHello</text>
<text x="88" y="164">{...}</text>
<text x="168" y="180">attested-key-ext-request(</text>
<text x="208" y="196">trusted-verifiers([Verifier X])</text>
<text x="72" y="212">)</text>
<text x="416" y="244">sign(TIK, hs)</text>
<text x="416" y="276">sig</text>
<text x="128" y="308">ServerHello</text>
<text x="120" y="324">{...}</text>
<text x="200" y="340">attested-key-ext-provide(</text>
<text x="196" y="356">verifier(Verifier X)</text>
<text x="104" y="372">)</text>
<text x="152" y="388">Certificate(AR{})</text>
<text x="172" y="404">CertificateVerify(sig)</text>
<text x="116" y="420">Finished</text>
<text x="136" y="468">verify AR{}</text>
<text x="132" y="516">verify sig</text>
<text x="180" y="548">Finished</text>
<text x="188" y="612">application data</text>
</g>
</svg>
