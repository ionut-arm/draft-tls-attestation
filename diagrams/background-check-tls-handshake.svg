<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1136" width="600" viewBox="0 0 600 1136" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
<path d="M 8,32 L 8,64" fill="none" stroke="black"/>
<path d="M 8,96 L 8,1056" fill="none" stroke="black"/>
<path d="M 32,64 L 32,96" fill="none" stroke="black"/>
<path d="M 32,128 L 32,1072" fill="none" stroke="black"/>
<path d="M 112,32 L 112,64" fill="none" stroke="black"/>
<path d="M 136,112 L 136,128" fill="none" stroke="black"/>
<path d="M 168,32 L 168,64" fill="none" stroke="black"/>
<path d="M 200,64 L 200,1120" fill="none" stroke="black"/>
<path d="M 240,32 L 240,64" fill="none" stroke="black"/>
<path d="M 280,336 L 280,344" fill="none" stroke="black"/>
<path d="M 368,32 L 368,64" fill="none" stroke="black"/>
<path d="M 400,64 L 400,1120" fill="none" stroke="black"/>
<path d="M 440,32 L 440,64" fill="none" stroke="black"/>
<path d="M 480,16 L 480,64" fill="none" stroke="black"/>
<path d="M 552,64 L 552,1072" fill="none" stroke="black"/>
<path d="M 592,16 L 592,64" fill="none" stroke="black"/>
<path d="M 592,128 L 592,1072" fill="none" stroke="black"/>
<path d="M 480,16 L 592,16" fill="none" stroke="black"/>
<path d="M 8,32 L 112,32" fill="none" stroke="black"/>
<path d="M 168,32 L 240,32" fill="none" stroke="black"/>
<path d="M 368,32 L 440,32" fill="none" stroke="black"/>
<path d="M 8,64 L 112,64" fill="none" stroke="black"/>
<path d="M 168,64 L 240,64" fill="none" stroke="black"/>
<path d="M 368,64 L 440,64" fill="none" stroke="black"/>
<path d="M 480,64 L 592,64" fill="none" stroke="black"/>
<path d="M 8,96 L 120,96" fill="none" stroke="black"/>
<path d="M 8,128 L 592,128" fill="none" stroke="black"/>
<path d="M 40,160 L 200,160" fill="none" stroke="black"/>
<path d="M 32,272 L 192,272" fill="none" stroke="black"/>
<path d="M 200,384 L 392,384" fill="none" stroke="black"/>
<path d="M 208,512 L 400,512" fill="none" stroke="black"/>
<path d="M 400,592 L 544,592" fill="none" stroke="black"/>
<path d="M 408,624 L 552,624" fill="none" stroke="black"/>
<path d="M 400,656 L 544,656" fill="none" stroke="black"/>
<path d="M 408,688 L 552,688" fill="none" stroke="black"/>
<path d="M 208,752 L 400,752" fill="none" stroke="black"/>
<path d="M 40,848 L 200,848" fill="none" stroke="black"/>
<path d="M 32,912 L 192,912" fill="none" stroke="black"/>
<path d="M 200,928 L 224,928" fill="none" stroke="black"/>
<path d="M 208,960 L 224,960" fill="none" stroke="black"/>
<path d="M 200,976 L 224,976" fill="none" stroke="black"/>
<path d="M 208,1008 L 224,1008" fill="none" stroke="black"/>
<path d="M 200,1040 L 392,1040" fill="none" stroke="black"/>
<path d="M 24,1072 L 592,1072" fill="none" stroke="black"/>
<path d="M 208,1104 L 392,1104" fill="none" stroke="black"/>
<path d="M 120,96 C 128.83064,96 136,103.16936 136,112" fill="none" stroke="black"/>
<path d="M 224,928 C 232.83064,928 240,935.16936 240,944" fill="none" stroke="black"/>
<path d="M 224,960 C 232.83064,960 240,952.83064 240,944" fill="none" stroke="black"/>
<path d="M 224,976 C 232.83064,976 240,983.16936 240,992" fill="none" stroke="black"/>
<path d="M 224,1008 C 232.83064,1008 240,1000.83064 240,992" fill="none" stroke="black"/>
<path d="M 24,1072 C 15.16936,1072 8,1064.83064 8,1056" fill="none" stroke="black"/>
<polygon class="arrowhead" points="552,656 540,650.4 540,661.6" fill="black" transform="rotate(0,544,656)"/>
<polygon class="arrowhead" points="552,592 540,586.4 540,597.6" fill="black" transform="rotate(0,544,592)"/>
<polygon class="arrowhead" points="416,688 404,682.4 404,693.6" fill="black" transform="rotate(180,408,688)"/>
<polygon class="arrowhead" points="416,624 404,618.4 404,629.6" fill="black" transform="rotate(180,408,624)"/>
<polygon class="arrowhead" points="400,1104 388,1098.4 388,1109.6" fill="black" transform="rotate(0,392,1104)"/>
<polygon class="arrowhead" points="400,1040 388,1034.4 388,1045.6" fill="black" transform="rotate(0,392,1040)"/>
<polygon class="arrowhead" points="400,384 388,378.4 388,389.6" fill="black" transform="rotate(0,392,384)"/>
<polygon class="arrowhead" points="216,1104 204,1098.4 204,1109.6" fill="black" transform="rotate(180,208,1104)"/>
<polygon class="arrowhead" points="216,1008 204,1002.4 204,1013.6" fill="black" transform="rotate(180,208,1008)"/>
<polygon class="arrowhead" points="216,960 204,954.4 204,965.6" fill="black" transform="rotate(180,208,960)"/>
<polygon class="arrowhead" points="216,752 204,746.4 204,757.6" fill="black" transform="rotate(180,208,752)"/>
<polygon class="arrowhead" points="216,512 204,506.4 204,517.6" fill="black" transform="rotate(180,208,512)"/>
<polygon class="arrowhead" points="200,912 188,906.4 188,917.6" fill="black" transform="rotate(0,192,912)"/>
<polygon class="arrowhead" points="200,272 188,266.4 188,277.6" fill="black" transform="rotate(0,192,272)"/>
<polygon class="arrowhead" points="48,848 36,842.4 36,853.6" fill="black" transform="rotate(180,40,848)"/>
<polygon class="arrowhead" points="48,160 36,154.4 36,165.6" fill="black" transform="rotate(180,40,160)"/>
<g class="text">
<text x="536" y="36">Attestation</text>
<text x="60" y="52">Verifier X</text>
<text x="204" y="52">Client</text>
<text x="404" y="52">Server</text>
<text x="520" y="52">Service</text>
<text x="72" y="116">TLS handshake</text>
<text x="116" y="148">POST /newSession</text>
<text x="88" y="180">201 Created</text>
<text x="116" y="196">Location: /76839A9</text>
<text x="72" y="212">Body: {</text>
<text x="84" y="228">nonce,</text>
<text x="124" y="244">supp-media-types</text>
<text x="48" y="260">}</text>
<text x="256" y="292">ClientHello</text>
<text x="240" y="308">{...}</text>
<text x="288" y="324">evidence_request(</text>
<text x="256" y="340">nonce</text>
<text x="284" y="356">types(x,b,c)</text>
<text x="224" y="372">)</text>
<text x="256" y="404">ServerHello</text>
<text x="240" y="420">{...}</text>
<text x="288" y="436">EncryptedExtensions</text>
<text x="240" y="452">{...}</text>
<text x="288" y="468">evidence_request(</text>
<text x="264" y="484">type(a)</text>
<text x="224" y="500">)</text>
<text x="472" y="532">attest_key(</text>
<text x="468" y="548">nonce,</text>
<text x="476" y="564">TIK-S-ID</text>
<text x="432" y="580">)</text>
<text x="464" y="612">CAB(KAT, PAT)</text>
<text x="480" y="644">sign(TIK-S-ID,hs)</text>
<text x="456" y="676">sig</text>
<text x="292" y="708">Certificate(KAT,PAT)</text>
<text x="300" y="724">CertificateVerify(sig)</text>
<text x="244" y="740">Finished</text>
<text x="100" y="772">POST /76839A9E</text>
<text x="72" y="788">Body: {</text>
<text x="92" y="804">type(a),</text>
<text x="72" y="820">CAB</text>
<text x="48" y="836">}</text>
<text x="72" y="868">Body: {</text>
<text x="124" y="884">att-result: AR{}</text>
<text x="48" y="900">}</text>
<text x="296" y="948">verify AR{}</text>
<text x="292" y="996">verify sig</text>
<text x="292" y="1028">Finished</text>
<text x="300" y="1092">application data</text>
</g>
</svg>
