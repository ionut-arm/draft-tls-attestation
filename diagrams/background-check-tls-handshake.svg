<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1072" width="592" viewBox="0 0 592 1072" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
<path d="M 8,16 L 8,48" fill="none" stroke="black"/>
<path d="M 8,80 L 8,992" fill="none" stroke="black"/>
<path d="M 32,48 L 32,80" fill="none" stroke="black"/>
<path d="M 32,112 L 32,1008" fill="none" stroke="black"/>
<path d="M 112,16 L 112,48" fill="none" stroke="black"/>
<path d="M 136,96 L 136,112" fill="none" stroke="black"/>
<path d="M 176,16 L 176,48" fill="none" stroke="black"/>
<path d="M 208,48 L 208,1056" fill="none" stroke="black"/>
<path d="M 240,16 L 240,48" fill="none" stroke="black"/>
<path d="M 376,16 L 376,48" fill="none" stroke="black"/>
<path d="M 408,48 L 408,576" fill="none" stroke="black"/>
<path d="M 408,608 L 408,1056" fill="none" stroke="black"/>
<path d="M 440,16 L 440,48" fill="none" stroke="black"/>
<path d="M 496,16 L 496,48" fill="none" stroke="black"/>
<path d="M 536,48 L 536,1008" fill="none" stroke="black"/>
<path d="M 576,128 L 576,992" fill="none" stroke="black"/>
<path d="M 584,16 L 584,48" fill="none" stroke="black"/>
<path d="M 8,16 L 112,16" fill="none" stroke="black"/>
<path d="M 176,16 L 240,16" fill="none" stroke="black"/>
<path d="M 376,16 L 440,16" fill="none" stroke="black"/>
<path d="M 496,16 L 584,16" fill="none" stroke="black"/>
<path d="M 8,48 L 112,48" fill="none" stroke="black"/>
<path d="M 176,48 L 240,48" fill="none" stroke="black"/>
<path d="M 376,48 L 440,48" fill="none" stroke="black"/>
<path d="M 496,48 L 584,48" fill="none" stroke="black"/>
<path d="M 8,80 L 120,80" fill="none" stroke="black"/>
<path d="M 8,112 L 560,112" fill="none" stroke="black"/>
<path d="M 40,144 L 208,144" fill="none" stroke="black"/>
<path d="M 32,256 L 200,256" fill="none" stroke="black"/>
<path d="M 208,368 L 400,368" fill="none" stroke="black"/>
<path d="M 408,448 L 528,448" fill="none" stroke="black"/>
<path d="M 416,480 L 536,480" fill="none" stroke="black"/>
<path d="M 408,512 L 528,512" fill="none" stroke="black"/>
<path d="M 416,544 L 536,544" fill="none" stroke="black"/>
<path d="M 216,688 L 408,688" fill="none" stroke="black"/>
<path d="M 40,784 L 208,784" fill="none" stroke="black"/>
<path d="M 32,848 L 200,848" fill="none" stroke="black"/>
<path d="M 208,864 L 232,864" fill="none" stroke="black"/>
<path d="M 216,896 L 232,896" fill="none" stroke="black"/>
<path d="M 208,912 L 232,912" fill="none" stroke="black"/>
<path d="M 216,944 L 232,944" fill="none" stroke="black"/>
<path d="M 208,976 L 400,976" fill="none" stroke="black"/>
<path d="M 24,1008 L 560,1008" fill="none" stroke="black"/>
<path d="M 216,1040 L 400,1040" fill="none" stroke="black"/>
<path d="M 120,80 C 128.83064,80 136,87.16936 136,96" fill="none" stroke="black"/>
<path d="M 560,112 C 568.83064,112 576,119.16936 576,128" fill="none" stroke="black"/>
<path d="M 232,864 C 240.83064,864 248,871.16936 248,880" fill="none" stroke="black"/>
<path d="M 232,896 C 240.83064,896 248,888.83064 248,880" fill="none" stroke="black"/>
<path d="M 232,912 C 240.83064,912 248,919.16936 248,928" fill="none" stroke="black"/>
<path d="M 232,944 C 240.83064,944 248,936.83064 248,928" fill="none" stroke="black"/>
<path d="M 24,1008 C 15.16936,1008 8,1000.83064 8,992" fill="none" stroke="black"/>
<path d="M 560,1008 C 568.83064,1008 576,1000.83064 576,992" fill="none" stroke="black"/>
<polygon class="arrowhead" points="536,512 524,506.4 524,517.6 " fill="black" transform="rotate(0,528,512)"/>
<polygon class="arrowhead" points="536,448 524,442.4 524,453.6 " fill="black" transform="rotate(0,528,448)"/>
<polygon class="arrowhead" points="424,544 412,538.4 412,549.6 " fill="black" transform="rotate(180,416,544)"/>
<polygon class="arrowhead" points="424,480 412,474.4 412,485.6 " fill="black" transform="rotate(180,416,480)"/>
<polygon class="arrowhead" points="408,1040 396,1034.4 396,1045.6 " fill="black" transform="rotate(0,400,1040)"/>
<polygon class="arrowhead" points="408,976 396,970.4 396,981.6 " fill="black" transform="rotate(0,400,976)"/>
<polygon class="arrowhead" points="408,368 396,362.4 396,373.6 " fill="black" transform="rotate(0,400,368)"/>
<polygon class="arrowhead" points="224,1040 212,1034.4 212,1045.6 " fill="black" transform="rotate(180,216,1040)"/>
<polygon class="arrowhead" points="224,944 212,938.4 212,949.6 " fill="black" transform="rotate(180,216,944)"/>
<polygon class="arrowhead" points="224,896 212,890.4 212,901.6 " fill="black" transform="rotate(180,216,896)"/>
<polygon class="arrowhead" points="224,688 212,682.4 212,693.6 " fill="black" transform="rotate(180,216,688)"/>
<polygon class="arrowhead" points="208,848 196,842.4 196,853.6 " fill="black" transform="rotate(0,200,848)"/>
<polygon class="arrowhead" points="208,256 196,250.4 196,261.6 " fill="black" transform="rotate(0,200,256)"/>
<polygon class="arrowhead" points="48,784 36,778.4 36,789.6 " fill="black" transform="rotate(180,40,784)"/>
<polygon class="arrowhead" points="48,144 36,138.4 36,149.6 " fill="black" transform="rotate(180,40,144)"/>
<g class="text">
<text x="60" y="36">Verifier X</text>
<text x="208" y="36">TLS A</text>
<text x="408" y="36">TLS B</text>
<text x="540" y="36">Attester</text>
<text x="72" y="100">TLS handshake</text>
<text x="116" y="132">POST /newSession</text>
<text x="88" y="164">201 Created</text>
<text x="120" y="180">Location: /76839A9E</text>
<text x="72" y="196">Body: {</text>
<text x="84" y="212">nonce,</text>
<text x="124" y="228">supp-media-types</text>
<text x="48" y="244">}</text>
<text x="264" y="276">ClientHello</text>
<text x="248" y="292">{...}</text>
<text x="312" y="308">attested-key-ext-req(</text>
<text x="268" y="324">nonce,</text>
<text x="308" y="340">supp-media-types</text>
<text x="232" y="356">)</text>
<text x="464" y="388">attest_key(</text>
<text x="460" y="404">nonce,</text>
<text x="448" y="420">TIK</text>
<text x="424" y="436">)</text>
<text x="464" y="468">KAT</text>
<text x="472" y="500">sign(TIK, hs)</text>
<text x="464" y="532">sig</text>
<text x="264" y="564">ServerHello</text>
<text x="248" y="580">{...}</text>
<text x="328" y="596">attested-key-ext-provide(</text>
<text x="300" y="612">kat-media-type</text>
<text x="232" y="628">)</text>
<text x="284" y="644">Certificate(KAT)</text>
<text x="308" y="660">CertificateVerify(sig)</text>
<text x="252" y="676">Finished</text>
<text x="100" y="708">POST /76839A9E</text>
<text x="72" y="724">Body: {</text>
<text x="120" y="740">kat-media-type,</text>
<text x="72" y="756">KAT</text>
<text x="48" y="772">}</text>
<text x="72" y="804">Body: {</text>
<text x="124" y="820">att-result: AR{}</text>
<text x="48" y="836">}</text>
<text x="304" y="884">verify AR{}</text>
<text x="300" y="932">verify sig</text>
<text x="300" y="964">Finished</text>
<text x="308" y="1028">application data</text>
</g>
</svg>
